Co&Co App Server

Co&Co App is a platform for hobbyist to connect and show off their collection

This app has :

- RESTful endpoint for Collection's CRUD operation(Admin)
- JSON formatted response

&nbsp;

Tech Stack used to build this app :

- Node JS
- Express JS framework
- PostgreSQL
- Sequelize ORM
- bcryptjs
- JWT
- cors
- google auth library
- jest
- supertest

&nbsp;

# POST /register

> Create new User

_Request Header_

```
not needed
```

_Request Body_

```
{
  "email": "<email to get insert into>",
  "password": "<password to get insert into>",
}
```

_Response (201 - Created)_

```
{
 "username": "<posted username>",
 "email": "<posted email>",
 "id":"<id generated by system>",
}
```

_Response (400 - Bad Request)_

```
{
  "message": "email sudah terdaftar" || "format email salah" || "password minimal 6 karakter"
}
```

_Response (500 - Internal Server Error)_

# POST /loginadmin

> login admin to get authentication(access_token)
> that is required to operate product's CRUD

_Request Header_

```
not needed
```

_Request Body_

```
{
  "email": "<email to log into>",
  "password": "<password to log into>",
}
```

_Response (200 - logged)_

```
{
 "email": "<logged email>",
 "id":"<logged id >",
 "role":"<admin role(true)>"
 "access_token":<generated by server>"
}
```

_Response (400 - Bad Request)_

```
{
  "message": "email atau password salah!"
}
```

_Response (401 - Unathorized)_

```
{
  "message": "this site is for admin only"
}
```

_Response (500 - Internal Server Error)_

# POST /login

> login customer get authentication(access_token)

_Request Header_

```
not needed
```

_Request Body_

```
{
  "email": "<email to log into>",
  "password": "<password to log into>",
}
```

_Response (200 - logged)_

```
{
  "id": <given id by system>,
  "email": "<logged email>",
  "role":"<customer role(false)>",
  "access_token":<generated by server>"
}
```

_Response (400 - Bad Request)_

```
{
  "message": "email atau password salah!"
}
```

_Response (401 - Unathorized)_

```
{
  "message": "this site is for customer only"
}
```

_Response (500 - Internal Server Error)_

# POST /googlelogin

> login by google id to get authentication(access_token)

_Request Header_

```
not needed
```

_Request Body_

```
{
  "id_token": "<token generated by google>",

}
```

_Response (200 - logged)_

```
{
  "id": <given id by system>,
  "email": "<posted email>",
  "access_token":<generated by server>
}
```

_Response (400 - Bad Request)_

```
{
  "message": "Invalid requests"
}
```

_Response (500 - Internal Server Error)_

# RESTful endpoints

## GET /products

> show all products
> _Request Header_

```
not needed
```

_Request Body_

```
not needed
```

_Response (200 - OK)_

```
[
  {
    "id": 1,
    "name": "<product's name>",
    "category": "<product's category>",
    "price":"<product's price>",
    "stock":"<product's stock>",
    "imgUrl":"<product's stock>",
    "createdAt": "<product's createdAt>",
    "updatedAt": "<product's updatedAt>",
  },
  {
    "id": 2,
    "name": "<product's name>",
    "category": "<product's category>",
    "price":"<product's price>",
    "stock":"<product's stock>",
    "imgUrl":"<product's stock>",
    "createdAt": "<product's createdAt>",
    "updatedAt": "<product's updatedAt>",
  }
]
```

_Response (500 - Internal Server Error)_

# POST /products

> Create new product

_Request Header_

```
{
  "access_token": "<admin access token>"
}
```

_Request Body_

```
{
  "name": "<name to get insert into>",
  "category": "<category to get insert into>",
  "stock": "<stock to get insert into>",
  "price": "<price to get insert into>",
  "imgUrl": "<imgUrl to get insert into>",
}
```

_Response (201 - Created)_

```
{
  "id": <given id by system>,
  "name": "<posted name>",
  "category":"<posted category>",
  "price":"<posted price>",
  "stock":"<posted stock>",
  "imgUrl":"<posted imgUrl>",
  "createdAt": "<time product's created>",
  "updatedAt": "<time product's last updated>",
}
```

_Response (400 - Bad Request)_

```
{
  "message": "nama produk tidak boleh kosong" || "Validation min on price failed" ||  "Validation min on stock failed" || "data tidak sesuai"
}
```

_Response (401 - Unathorized)_

```
{
  "message": "Please Login first!" || "hanya bisa dilakukan oleh admin"
}
```

_Response (500 - Internal Server Error)_

# PUT /products/:id

> Update product defined by the id provided

_Request Header_

```
{
  "access_token": "<admin access token>"
}
```

_Request Params_

```
{
  "id" : "<product id to update>"
}
```

_Request Body_

```
{
  "name": "<name to putted into>",
  "category": "<category to putted into>",
  "stock": "<stock to putted into>",
  "price": "<price to putted into>",
  "imgUrl": "<imgUrl to putted into>",
}
```

_Response (200 - updated)_

```
{
  "name": "<putted name>",
  "category": "<putted category>",
  "stock": "<putted stock>",
  "price": "<putted price>",
  "imgUrl": "<putted imgUrl>",
}
```

_Response (404 - Not found)_

```
{
  name:'NotFound',
  message:'Not Found'
}
```

_Response (400 - Bad Request)_

```
{
  "message": "nama produk tidak boleh kosong" || "Validation min on price failed" ||  "Validation min on stock failed" || "data tidak sesuai"
}
```

_Response (401 - Unathorized)_

```
{
  "message": "Please Login first!" || "hanya bisa dilakukan oleh admin"
}
```

_Response (500 - Internal Server Error)_

# DELETE /products/:id

> Delete product defined by id provided

_Request Header_

```
{
  "access_token": "<admin access token>"
}
```

_Request Params_

```
{
  "id" : <product id to delete>
}
```

_Response (200 - deleted)_

```
{
  "id": "<deleted id>",
  "name": "<deleted product name>",
  "stock": "<deleted product stock>",
  "price": "<deleted product price>",
  "imgUrl": "<deleted product imgUrl>",
  "category": "<deleted task category>",
  "createdAt": "<deleted task createdAt>",
  "updatedAt": "<deleted task updatedAt>",
}
```

_Response (404 - Not found)_

```
{
  name:'NotFound',
  message:'Not Found'
}
```

_Response (401 - Unathorized)_

```
{
  "message": "Please Login first!" || "hanya bisa dilakukan oleh admin"
}
```

_Response (500 - Internal Server Error)_

# GET /carts

> Show all pending carts owned by customer

_Request Header_

```
{
  "access_token": "<customer access token>"
}
```

_Request Body_

```
not needed
```

_Response (200 - OK)_

```
[
  {
    "id": 1,
    "UserId": "<cart's UserId>",
    "ProductId": "<cart's ProductId>",
    "status":"<false>",
    "totalPrice":"<cart's totalPrice>",
    "quantity":"<cart's quantity>",
    "Product":
    {
    "id": "<product's id>",
    "name": "<product's name>",
    "category": "<product's category>",
    "price":"<product's price>",
    "stock":"<product's stock>",
    "imgUrl":"<product's stock>",
    "createdAt": "<product's createdAt>",
    "updatedAt": "<product's updatedAt>",

    }
  },
  {
    "id": 2,
    "UserId": "<cart's UserId>",
    "ProductId": "<cart's ProductId>",
    "status":"<false>",
    "totalPrice":"<cart's totalPrice>",
    "quantity":"<cart's quantity>",
    "Product":
    {
    "id": "<product's id>",
    "name": "<product's name>",
    "category": "<product's category>",
    "price":"<product's price>",
    "stock":"<product's stock>",
    "imgUrl":"<product's stock>",
    "createdAt": "<product's createdAt>",
    "updatedAt": "<product's updatedAt>",
    }
  },
]
```

_Response (401 - Unathorized)_

```
{
  "message": "this site is for customer only" || "Please Login first!" || "hanya bisa dilakukan oleh customer"
}
```

_Response (500 - Internal Server Error)_

# POST /carts/:ProductId

> Create new cart or add quantity to existing customer's cart

_Request Header_

```
{
  "access_token": "<customer access token>"
}
```

_Request Params_

```
{
  "ProductId" : "<cart's ProductId>"
}
```

_Request Body_

```
not needed
```

_Response (200 - OK)_

```
{
  "id": 1,
    "UserId": "<cart's UserId>",
    "ProductId": "<cart's ProductId>",
    "status":"<defaultValue false>",
    "totalPrice":"<cart's totalPrice>",
    "quantity":"<cart's quantity>",
    "Product":
    {
    "id": "<product's id>",
    "name": "<product's name>",
    "category": "<product's category>",
    "price":"<product's price>",
    "stock":"<product's stock>",
    "imgUrl":"<product's stock>",
    "createdAt": "<product's createdAt>",
    "updatedAt": "<product's updatedAt>",

    }
}
```

_Response (201 - Created)_

```
{"id": 1,
    "UserId": "<cart's UserId>",
    "ProductId": "<cart's ProductId>",
    "status":"<defaultValue false>",
    "totalPrice":"<cart's totalPrice>",
    "quantity":"<cart's quantity>",
    "Product":
    {
    "id": "<product's id>",
    "name": "<product's name>",
    "category": "<product's category>",
    "price":"<product's price>",
    "stock":"<product's stock>",
    "imgUrl":"<product's stock>",
    "createdAt": "<product's createdAt>",
    "updatedAt": "<product's updatedAt>",

    }
```

_Response (400 - Bad Request)_

```
{
  "message": "No more stock left"
}
```

_Response (401 - Unathorized)_

```
{
  "message": "this site is for customer only" || "Please Login first!" || "hanya bisa dilakukan oleh customer"
}
```

_Response (500 - Internal Server Error)_

# PUT /carts/:ProductId

> Reduce cart quantity or delete customer's cart

_Request Header_

```
{
  "access_token": "<customer access token>"
}
```

_Request Params_

```
{
  "ProductId" : "<cart's ProductId>"
}
```

_Request Body_

```
not needed
```

_Response (200 - OK)_

```
{
  "id": 1,
    "UserId": "<cart's UserId>",
    "ProductId": "<cart's ProductId>",
    "status":"<cart's status>",
    "totalPrice":"<cart's totalPrice>",
    "quantity":"<cart's quantity>",
    "Product":
    {
    "id": "<product's id>",
    "name": "<product's name>",
    "category": "<product's category>",
    "price":"<product's price>",
    "stock":"<product's stock>",
    "imgUrl":"<product's stock>",
    "createdAt": "<product's createdAt>",
    "updatedAt": "<product's updatedAt>",

    }
}
```

_Response (200 - Deleted)_

```
{ message: "cart deleted" }
```

_Response (401 - Unathorized)_

```
{
  "message": "this site is for customer only" || "Please Login first!" || "hanya bisa dilakukan oleh customer"
}
```

_Response (500 - Internal Server Error)_

# GET /carts/checkout

> Change customer's cart status to true

_Request Header_

```
{
  "access_token": "<customer access token>"
}
```

_Request Body_

```
not needed
```

_Response (200 - OK)_

```
[
  {
    "id": 1,
    "UserId": "<cart's UserId>",
    "ProductId": "<cart's ProductId>",
    "status":true ,
    "totalPrice":"<cart's totalPrice>",
    "quantity":"<cart's quantity>",
  },
  {
    "id": 2,
    "UserId": "<cart's UserId>",
    "ProductId": "<cart's ProductId>",
    "status": true,
    "totalPrice":"<cart's totalPrice>",
    "quantity":"<cart's quantity>",

  },
]
```

_Response (401 - Unathorized)_

```
{
  "message": "this site is for customer only" || "Please Login first!" || "hanya bisa dilakukan oleh customer"
}
```

_Response (500 - Internal Server Error)_

# GET /carts/history

> Show all completed carts owned by customer

_Request Header_

```
{
  "access_token": "<customer access token>"
}
```

_Request Body_

```
not needed
```

_Response (200 - OK)_

```
[
  {
    "id": 1,
    "UserId": "<cart's UserId>",
    "ProductId": "<cart's ProductId>",
    "status":"<false>",
    "totalPrice":"<cart's totalPrice>",
    "quantity":"<cart's quantity>",
  },
  {
    "id": 2,
    "UserId": "<cart's UserId>",
    "ProductId": "<cart's ProductId>",
    "status":"<false>",
    "totalPrice":"<cart's totalPrice>",
    "quantity":"<cart's quantity>",
  },
]
```

_Response (401 - Unathorized)_

```
{
  "message": "this site is for customer only" || "Please Login first!" || "hanya bisa dilakukan oleh customer"
}
```

_Response (500 - Internal Server Error)_

# DELETE /carts/:ProductId

> Delete cart defined by ProductId provided

_Request Header_

```
{
  "access_token": "<customer access token>"
}
```

_Request Params_

```
{
  "ProductId" : <cart's ProductId to delete>
}
```

_Response (200 - deleted)_

```
{
  "message" : "cart deleted"
}
```

_Response (404 - Not found)_

```
{
  name:'NotFound',
  message:'Not Found'
}
```

_Response (401 - Unathorized)_

```
{
  "message": "Please Login first!" || "hanya bisa dilakukan oleh customer"
}
```

_Response (500 - Internal Server Error)_
